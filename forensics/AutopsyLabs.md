# From Autopsy 1 day training course
## Download List
* [Autopsy](http://www.autopsy.com/download)
* [Devices](https://file.ac/1Li7wEbJZvg/)
* [NIST NSRL Hash Set](https://sourceforge.net/projects/autopsy/files/NSRL/NSRL-270m-Autopsy.zip/download)
* [Video Triage Module](https://www.autopsy.com/add-on-modules/video-triage/)


# Lab 0
```
We will now install Autopsy on your computer so that we can later do hands-on activities. 

You should have downloaded the ".msi" installer in Section 1. 
Install it using the default options. 
Launch Autopsy and enable the Central Repository using a SQLite database in the default AppData location. 
```

# Lab 1
```
Before we begin the lab, make sure you downloaded the images that were listed back in Section 1.
If you want to confirm that you had no corruption, these are the MD5 values of the files:

MD5 (device1_laptop.e01) = dc176d653c5613e305e831525e874090
MD5 (device2_mediacard.e01) = c8343d3976eec2985e7580a2b6321591
We will now begin the analysis of the hard drive that was found in the dognappers car.  
At this point in the scenario, we haven’t searched the house yet and therefore will not 
have access to the media card device.  So, make sure you do not add that yet. 

Launch Autopsy

Choose “Create New Case”

Make a case with the following information:
Case Name: case1

Base Directory: c:\  (or where ever you'd like to store the case)

Skip case number and examiner

Add device1_laptop.e01 image as data source.  
***** NOTE: Do NOT add device2_mediacard.e01 yet *****

Deselect ALL ingest modules.  
- As a reminder, this is not what you’d typically do.  But, we are doing it this way for the course. 

Finish Adding Image.

Open the “Data Sources” part of the left-hand tree (we’ll cover this tree more in the next section). 
Question: How many volumes does the disk image have? 
Question: What is the name of the unallocated space file in vol1? 
Question: Right click on vol7 and choose “File System Details”.  What file system is in vol7?  
In Windows, open “C:\case1” in a file explorer and observe its contents. 
Question: What is the database called?
Question: Roughly how big is the database (in megabytes)?
```
# Lab 2
```
Keep the same case open that you created in the last section.  Let’s look at the data in the tree.

Question: By extension, how many databases are there? 

Question: What is the size of the largest database? 

Question: Are there any databases by MIME type yet? 

Question: What are the names of the files between 200MB and 1GB in size?
```

# Lab 3
```
We are now going to begin analyzing the laptop.  We are starting off the case with some clues. 
Most notably, we have pictures that were sent with the ransom emails to Basis Technology

Keep same case open from previous lab, or reopen the case ("case1"). 

Right click on device1_laptop.e01 image in tree and choose “Run Ingest Modules”

Disable all modules except the following (we will pre-load some for the next lap):

Hash Lookup

File Type Identification

Extension Mismatch Detector

Embedded File Extractor

Exif Parser

Email Parser

Central Repository

Configure the Hash Lookup module with two hash sets:

Import the NSRL File (NSRLComplete.txt-md5.idx) that you previously downloaded in Section 1.  

You may need to unzip the file you downloaded.  

You can use the default values (i.e. Type: Known).

Create a New Hash Set:

Destination: Local

Name: Ransom Case

Hash Set Path: [Any folder on your computer]

Type: Notable

Use "Add Hashes to Hash Set" button to copy and paste the following MD5 value into the "Ransom Case" 
hash set.  This is the hash of the ransom note.
07c94320f4e41291f855d450f68c8c5b

Start the Ingest Modules.

Observe:

Use Ingest Inbox as an indicator when ‘Known Bad’ hash hits are found. 

Use “Go To Result” to go to tree area of hash hits. 

View the hash hit.

Question: Let ingest get at least 15% through the drive.  How many total hits are found under the 
“Hashset Hits” results after running the Hash Lookup Ingest Module?

Question: What are the filenames of the hash hits? 

One of the hits is in a folder named “Pictures”.  Right click on the file to “View” there. 

Question: How many total ".jpg" files are in the folder “Pictures” where the notable hash hit was found?

While reviewing the images in that folder, it is noticed that “IMG_20191024_155744.jpg” shows health violations 
by bringing the dog into a restaurant.  We want to tag this as Notable:

Right click on it

Select “Add File Tag” and choose “Notable Item” 
```

# Lab 4

```
NOTE: We already ran the modules in the last lab. 

Question: Under the “Exif Metadata results, how many photos were taken with the following devices?

iPhone 7 Plus?

Samsung Galaxy S8?

BLU R1 HD?

From the “Views” area, find the archive file that is named “Archive.zip”.

Go to original directory (Right click -> View File In Directory). 

Double click on it to go into it. 

Question: What is the MIME type listed for the file “D3D11_Default.shader-db.bin”?

Question: What is the file size for the file “D3D11_Default.shader-db.bin”?”

Question: Are there extension mismatch results?

Question: What are some common file types with unexpected extensions? 

Run ingest again with only the Interesting Files module enabled. 
Create an Interesting File Set named “Encryption”.  With two rules that match files named “veracrypt.exe” or “truecrypt.exe”. 
Question: Was VeraCrypt found on the system?

Question: Was TrueCrypt found on the system?
```

# Lab 5

```
Run ingest with only “Recent Activity” enabled. 

Question: How many Web Bookmarks were found?

Question: What URL is a suspicious bookmark given the dognapping? 

Question: What day are the cookies associated with the domain “youtube.com” from?

Question: What is the Value associated with the Name “identification” under Web Form Autofill?

Question: Under Web History, what day were the following Google Searches performed?

“how to treat a dog bite”

“how to make a ransom note”

Question: How many non-VM USB devices were attached to the system?

NOTE: April 21, 2020: Some Linux systems are not getting a correct answer for this with Autopsy 4.14 because RegRipper cannot run. 
This problem was fixed in 4.15.

We are hearing about some Windows systems where the UI does not show the device IDs ( but they are saved into the case database).
You can then re-open the case and see the results. We are investigating why this happens.  

Question: How many file(s) is/are currently in the Recycle Bin?

What was likely the original name of the file(s)?

Question: Under Accounts, what is the username associated with the Twitter account found on the device?
```

# Lab 6
```
We will now run ingest and prepopulate with keywords that we already know about the case. 

Run ingest with “Keyword Search” enabled. 

Create a keyword list with the following words: 
Exact Match Keywords:  

renzik

Configure to update every 1 minute (so that you don’t have to wait too long - change it back after).

Start Ingest.

After it runs for a few percent of the files, you should see some hits.   They honestly aren’t that exciting, 
but they are good enough for this lab.  There are more relevant ones if you let it run until 15% or so. 

Question: There are references to a document with renzik.  What is the name of the file? 

Question: How many hits are there for “Renzik” in NTUSER.DAT?

Don’t forget to change your keyword search periodic timer back to 5 minutes.
```

# Lab 7

```
At this point in the scenario, the police have searched the house and, with the help of Siri the electronic sniffing K9, 
found a media card. We will add that to our case and find some correlations. 

Add device2_mediacard.e01 as a new data source (NOTE: We already added the device1_laptop.e01 data source to the Central
Repository during the Hash Lookup Lab)

Right click on device2_mediacard.e01 and run Ingest Modules, with the following enabled:

Hash Lookup

Exif Parser

Central Repository

Question: Was an Interesting Item created because a file on the media card was previously marked as notable?

Question: The picture on the laptop had a created date of 2019-11-01. What is the created date (in YYYY-MM-DD format) 
on the media card? 

Question: How many total .jpg files are in the same folder as the Notable file? 

Question: Look at the Other Occurrences tab for that file to see if it showed up anywhere else in this case with a different name.
If it was, what is the other name?
```
