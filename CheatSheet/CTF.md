# WEB

* check source code
* Send diff (HEAD,GET,POST,PUT etc)
* use default creds for the app
* modify accept header (application/json etc)
* add Headers (X-forwarded-for,X-contry)
* test host if it will call yours
* find source code (github)
* brute force dir | brute fore/bruteforce(common.txt, medium) with (-s 302,307,200,204,301,403)
* Sql injection (sql.txt) || def blind sql then
* 301 or 302 content? replace with 200
* check cert
* command injection
* prototype pollution [CS](https://blog.p6.is/Web-Security-CheatSheet/)
* snyk test (vuln packages)
* steghide -extract -sf "image"
* fuzz get n post req "ffuf -u http://10.10.10.218/api/FUZZ -w /wordlist"  "ffuf -u http://10.10.10.218/?api=FUZZ -w /wordlist/special-chars.txt"

# FORENSICS/STEG

* file
* strings
* exiftool
* steghide info <file> | steghide --extract -sf <file>
* binwalk -e | -Me

## Raw file with dwarf file and sys map 
The dwarf and system map can be zipped and put in the folder `volatility/plugins/overlays/linux/` to create a profile. The name of the created profile can be checked with `python2 vol.py --info | grep Profile` and in my case, it was Linuxphillipx64.

We can view the bash hisory using the command `python2 vol.py --profile=Linuxphillipx64 -f ../philip-1.raw linux_bash`
* RSA private keys can be found with memdump.py. https://github.com/Crapworks/pentest/blob/master/memdump.py
* get ssh key: `python2 memdump.py philip-1.raw`

# NETWORK PCAP

## ICMP 
```
It’s Wireshark, it’s a bunch of ICMP pings, each packet’s data contents are either all ones or all zeroes. Problem is there’s two duplicate packets (request, reply) but I just need one per bit. Use Wireshark to filter for just icmp.resp_in.

Now do File → Export Packet Dissections → As JSON → Displayed.

Copy paste the JSON into https://jqplay.org and use this filter: .[]._source.layers.icmp.data."data.data".

Copy paste the result into VS code, zoom out, use the multiline cursor to get just one column of text. Find/Replace to remove newlines and replace f with 1. Paste resultant binary into Cyberchef, convert from binary (to ASCII), get flag.
```
## Crack wifi
* `aircrack-ng -a2 -w rockyou.txt file.pcap`

# HITB CTF (training video)
Rules
* no DOS
* Dont't filter traffic by attributes but by payload



 * go to the cloud console
* enter token
* use help
* create_vm -> copy content to conn.ovpn
* take snapshot
* list_snapshots
* ssh in to box with password
* docker has the services `docker ps`
* cd home (the services folder)
* use scp -r user@IP.3:/home /your_local_machine_dir (to download/view the source code and patch)
* use scp -r /your_local_machine_dir_service user@IP.3:/home (to upload/update the source code)
* or use VSCODE to edit directly with ssh
* docker build to effect changes
* docker-compose up --force-recreate- d
* use tcpdump -i eth1 -w capture.pcap not src net youriprange/24 and port '(3306 or 80 0r 8080 others') -vv
* using caronte for capture(download from github) || cd caronte || docker-compose up -d
* * access on IP:3333 -> put your server addr (IP.3) -> regex /^\w{31}=$/ -> set user and password
* * add services 
* * add pcaps -> use second upload (volumes: \n\t- "root/pcaps:/pcaps")(in caronte docker-compose) (/pcaps will show in home)(dck --f-rec)
* * * process /pcaps/capture.pcap
* * use 'watch -n `secs` curl `upload version<add flush field`' -> auto adds captures


write script to get flags for common
e.g python exploit.py victim_ip => flag

Destructive farm
* apt install python3 python3-pip -y
* git clone <destruvtive farm>
* cd and pip install -r requirements.txt
* config
* * edit config.py (Teams ip,range,format, SYSTEM_URL/TOKEN\FLAG_LIFETIME
* * ./start_server.sh -> IP:5000
* ./start_sploit exploit.py --server-url http://IP:5000 --alias name

Protect apps
* remove exposed to local in dck-compose -> "127.0.0.1:3306"


