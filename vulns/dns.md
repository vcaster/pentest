# Setup in CentOS

## Install

* `yum install bind-chroot bind-utils`
* `/etc/named.conf`
```
add above options
acl AllowQuery {
        172.16.16.0/24;
        localhost;
        localnets;
};
modify 'listen-on port 53' in options
listen-on port 53 { localnets; }; // Or maby any

modify 'allow-query' in options
allow-query     { AllowQuery; };

add  in options
forwarders {
                8.8.8.8;
                8.8.4.4;
        };

```

* `sudo systemctl enable named --now`
* `sudo firewall-cmd --permanent --add-service=dns`
* `sudo firewall-cmd --reload`
* `nmcli con show`
* `sudo nmcli con edit <device>`
* `> remove ipv4.dns`
* `> set ipv4.dns 127.0.0.1`
* `> save`
* `> quit`
* `sudo systemctl restart NetworkManager.service`

## Create forward Zone

* `touch /var/named/chroot/var/named/malware.boss.db`
* `nano`
```
$TTL 5m

malware.boss. IN SOA dns.malware.boss. dnsadmin.malware.boss (
        1 ; Zone file serial number
        5m ; Refresh time
        3m ; Retry time
        30m ; Expiration time
        5m ) ; Negative TTL

; Name Servers

malware.boss.       IN      NS      dns.malware.boss.

; Address Records

dns          IN      A       172.16.16.201
kaly          IN      A       172.16.16.202
```
* check with `named-checkzone malware.boss malware.boss.db`

```
zone "malware.boss" in {
        type master;
        file "/var/named/chroot/var/named/malware.boss.db";
};
```
* check with `named-checkconf /etc/named.conf`

# Client/Users

* set dns config on clients with `nmtui` or settings && Turn off and on network
* `cat /etc/resolv.conf` to verify